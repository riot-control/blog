<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Riot Control]]></title>
  <link href="http://www.riot-control.net/atom.xml" rel="self"/>
  <link href="http://www.riot-control.net/"/>
  <updated>2014-07-10T15:48:56+01:00</updated>
  <id>http://www.riot-control.net/</id>
  <author>
    <name><![CDATA[]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Why good leaders make you feel safe]]></title>
    <link href="http://www.riot-control.net/2014/05/23/why-good-leaders-make-you-feel-safe/"/>
    <updated>2014-05-23T00:00:00+01:00</updated>
    <id>http://www.riot-control.net/2014/05/23/why-good-leaders-make-you-feel-safe</id>
    <content type="html"><![CDATA[<p>Do you feel safe?</p>

<iframe src="http://embed.ted.com/talks/simon_sinek_why_good_leaders_make_you_feel_safe.html" width="640" height="360" frameborder="0" scrolling="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Write your logic with purity]]></title>
    <link href="http://www.riot-control.net/2014/04/29/write-your-logic-with-purity/"/>
    <updated>2014-04-29T00:00:00+01:00</updated>
    <id>http://www.riot-control.net/2014/04/29/write-your-logic-with-purity</id>
    <content type="html"><![CDATA[<p>When I first learned about <a href="http://www.riot-control.net/2014/04/10/pure-functions/">pure functions</a>
I tried to map the concept to a core piece of logic on our product. It was hard,
and I spent some days figuring it out. The test functionality is an invoice
finalizer. We first had all that logic on the fat models, and then we refactored
it to <a href="http://www.riot-control.net/2013/12/03/the-almighty-interactor/">interactors</a>
and it was a huge improvement. Even so, all the <em>gateway</em> logic and such, seamed
like an unnecessary burden. This functionality, in ruby, is something like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">FinalizeDocument</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">attr_accessor</span> <span class="ss">:document</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">run</span>
</span><span class='line'>    <span class="n">lock</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">sequence</span> <span class="o">=</span> <span class="n">find_sequence</span>
</span><span class='line'>      <span class="n">document</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">increment</span><span class="p">(</span><span class="n">sequence</span><span class="o">.</span><span class="n">last_document</span><span class="p">)</span>
</span><span class='line'>      <span class="n">validate_document</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">document</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;final&#39;</span>
</span><span class='line'>      <span class="n">document</span><span class="o">.</span><span class="n">final_date</span> <span class="o">=</span> <span class="no">Time</span><span class="o">.</span><span class="n">now</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">document</span><span class="o">.</span><span class="n">calculate_totals</span>
</span><span class='line'>      <span class="n">document</span><span class="o">.</span><span class="n">sign_and_do_crypto_things</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">document</span><span class="o">.</span><span class="n">save!</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<!-- more -->


<p>A gateway object is used as an indirection to load and persist the required data,
and having this indirection enables us to test the interactor using memory objects,
instead of hitting the database. We are not coupled with a particular form of
persistence, but we are still coupled with the persistence operations. Do we
really need this? Or is it possible to remove the use of the gateway altogether?</p>

<p>A <em>pure function</em> doesn&rsquo;t mutate objects, and doesn&rsquo;t do IO. Our current version
relies heavily on mutating and IO. Using a pure function feels like improving
the code, but it doesn&rsquo;t seems possible on this scenario. I had to reset my way
of thinking to reach something that, at this moment, seems logical.</p>

<p>The turning point was when I started to say things differently. I don&rsquo;t want
a function that finalizes an invoice. I want a function that when given a
draft invoice, returns a version of that invoice as finalized. On scala, it
could be something like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">case</span> <span class="k">class</span> <span class="nc">Document</span><span class="o">(</span><span class="n">number</span> <span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">status</span> <span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="o">...)</span>
</span><span class='line'><span class="k">case</span> <span class="k">class</span> <span class="nc">DocumentItem</span><span class="o">(</span><span class="n">unitPrice</span> <span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">quantity</span> <span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="o">...)</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="n">finalize</span><span class="o">(</span><span class="n">draft</span><span class="k">:</span><span class="kt">Document</span><span class="o">,</span> <span class="n">previous</span><span class="k">:</span><span class="kt">Option</span><span class="o">[</span><span class="kt">Document</span><span class="o">])</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">val</span> <span class="n">v1</span> <span class="k">=</span> <span class="n">buildSequence</span><span class="o">(</span><span class="n">draft</span><span class="o">,</span> <span class="n">previous</span><span class="o">)</span>
</span><span class='line'>  <span class="k">val</span> <span class="n">v2</span> <span class="k">=</span> <span class="n">calculateTotals</span><span class="o">(</span><span class="n">v1</span><span class="o">)</span>
</span><span class='line'>  <span class="n">signData</span><span class="o">(</span><span class="n">v2</span><span class="o">)</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Using functional programming in scala, we could split all this and build the
<code>finalize</code> function as a composition of the other inner functions. All these
inner functions are also pure an can be unit tested on the side. This is a very
nice way to have independent, easily tested logic.</p>

<p>However, we have the logic, but still don&rsquo;t have the functionality. We aren&rsquo;t
persisting anything, so this function doesn&rsquo;t provide us with the side effects
that we want. The thing is, a program can&rsquo;t be solely composed of pure functions,
or else it wouldn&rsquo;t do anything useful. We can however, use our simple and
easily tested pure function that finalizes a document to implement this
functionality.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">def</span> <span class="n">finalizeInvoice</span><span class="o">(</span><span class="n">draftId</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">lock</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">draft</span> <span class="k">=</span> <span class="n">loadDraft</span><span class="o">(</span><span class="n">draftId</span><span class="o">)</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">previous</span> <span class="k">=</span> <span class="n">loadPrevious</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">finalized</span> <span class="k">=</span> <span class="n">finalize</span><span class="o">(</span><span class="n">draft</span><span class="o">,</span> <span class="n">previous</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">saveDocument</span><span class="o">(</span><span class="n">finalized</span><span class="o">)</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is a better way. We can have all the logic tested and on a module that
doesn&rsquo;t depend on ORMs, web frameworks, etc. And we can have another module
that puts everything together. I believe that this is the best approach for
building software and it&rsquo;s great for TDD.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[What it takes to be a great leader?]]></title>
    <link href="http://www.riot-control.net/2014/04/24/what-takes-to-be-a-great-leader/"/>
    <updated>2014-04-24T00:00:00+01:00</updated>
    <id>http://www.riot-control.net/2014/04/24/what-takes-to-be-a-great-leader</id>
    <content type="html"><![CDATA[<p>Interesting view on leadership.</p>

<ul>
<li>Where are you looking to anticipate change?</li>
<li>What is the diversity measure of your network?</li>
<li>Are you courageous enough to abandon the past?</li>
</ul>


<iframe src="http://embed.ted.com/talks/roselinde_torres_what_it_takes_to_be_a_great_leader.html" width="640" height="360" frameborder="0" scrolling="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Framework for Hapiness]]></title>
    <link href="http://www.riot-control.net/2014/04/22/framework-for-hapiness/"/>
    <updated>2014-04-22T00:00:00+01:00</updated>
    <id>http://www.riot-control.net/2014/04/22/framework-for-hapiness</id>
    <content type="html"><![CDATA[<p>Happiness matters. In this talk we are presented with Github&rsquo;s vision for happiness
in the workplace. It&rsquo;s hard to achieve a lot of those steps, specially when we
have managers and we don&rsquo;t see eye to eye. But that won&rsquo;t stop me from trying.</p>

<div class="ratio-4-3 embed-video-container" onclick="var myAnchor = document.getElementById('i0FzgvYxdvk');var tmpDiv = document.createElement('div');tmpDiv.innerHTML = '&lt;iframe style=&quot;vertical-align:top;width:100%;height:100%;position:absolute;&quot; src=&quot;http://www.youtube.com/embed/i0FzgvYxdvk?autoplay=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;';myAnchor.parentNode.replaceChild(tmpDiv.firstChild, myAnchor);return false;" title="click here to play">
<a class="youtube-lazy-link" style="width:100%;height:100%;background:#000 url(http://i2.ytimg.com/vi/i0FzgvYxdvk/0.jpg) center center no-repeat;background-size:contain;position:absolute" href="http://www.youtube.com/watch?v=i0FzgvYxdvk" id="i0FzgvYxdvk" onclick="return false;">
<div class="youtube-lazy-link-div"></div>
<div class="youtube-lazy-link-info">Tom Preston-Werner - Framework For Happiness - La Conf Paris 2013</div>
</a>
<div class="video-info" ></div>
</div>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[REWORK &amp; REMOTE: Office Not Required]]></title>
    <link href="http://www.riot-control.net/2014/04/21/rework-and-remote/"/>
    <updated>2014-04-21T21:01:00+01:00</updated>
    <id>http://www.riot-control.net/2014/04/21/rework-and-remote</id>
    <content type="html"><![CDATA[<p>
<img style="border-style:solid;border-color:black;" src="http://www.riot-control.net/images/rework.jpg" height="300px" width="200px"/>

<img style="border-style:solid;border-color:red;" src="http://www.riot-control.net/images/remote.png" height="300px" width="200px"/>
</p>


<p>Remember the <strong>Godfather</strong> movies? I bet you&rsquo;ve seen them before. (If you haven&rsquo;t, stop reading right now and go watch them. Just kidding.)</p>

<p>There are 3 Godfather movies: Part I, Part II and Part III. Let&rsquo;s just focus on Part I and Part II. Which one did you like the most? Part I? It&rsquo;s a classic, great movie. Do you think Part II is better? I know some people who do. It&rsquo;s also awesome. Both are great movies, there&rsquo;s no question about that.</p>

<p>The same happens with these two <strong>life changing books</strong>: REWORK and REMOTE. Both of them are so good it&rsquo;s hard to say which one is better.</p>

<p>These books have completely changed the way I work and how I manage to keep a <strong>healthy work-life balance</strong>.</p>

<p>Let me just give you an idea of what they talk about. Then, go read them and <strong>change your life forever</strong>.</p>

<!-- more -->


<p><strong>REWORK</strong> and <strong>REMOTE</strong> were written by <strong>Jason Fried</strong> and <strong>DHH</strong> from <strong>37signals/Basecamp</strong>.
REWORK focuses on how you can become a better worker. REMOTE is all about working outside the office and all the benefits and dangers that come with it. So, how can you become more productive?</p>

<p>For example, most people go to the office everyday. But they don&rsquo;t get that much work done. Their day is shredded into tiny moments. 10 minutes here, 20 minutes there. The office is full of <strong>interruptions</strong>. Try working outside the office for one day and see how much work you get done.</p>

<p>Since I&rsquo;m talking about the office, how about working from 9am-5pm? I mean, we&rsquo;re all supposed to be productive at the same time for 8 hours? What if somebody works better from 12pm-8pm? You should <strong>focus on the work</strong> you have to do, not at what time you do it. Some people get work done at offices really early in the morning or late in the afternoon when nobody&rsquo;s there to distract them. Seriously, <strong>it&rsquo;s the work that matters</strong>, not the clock.</p>

<p>Now, how about having flexible workdays outside the office? Most managers will come up with this excuse: &ldquo;If I can’t see them, how do I know they’re working?&rdquo;. <strong>Remote work is all about trust</strong>. Treat your employees like adults and you’ll be the manager. Treat them like children and you’ll be the babysitter. Some managers trust their employees, others like to control them.</p>

<blockquote><p><strong>&ldquo;To successfully work with other people, you have to trust each other. A big part of this is trusting people to get their work done wherever they are, without supervision.&rdquo; &ndash; Richard Branson</strong></p></blockquote>

<p>Another excuse managers come up with to avoid remote work is: &ldquo;People’s homes are full of distractions&rdquo;. Yes they are. And so are offices. The difference? At home you have <strong>voluntary distractions</strong>. It&rsquo;s up to you to stop working and go watch TV. If you’re tempted by home distractions, maybe your work isn’t motivating and meaningful. On the other hand, at the office you have <strong>involuntary distractions</strong> (coworkers, managers, meetings, etc.).</p>

<p><strong>Meetings and Managers</strong> are the main reasons work doesn’t get done at the office (Jason and David call them the <strong>M&amp;M&rsquo;s</strong>). Meetings are major distractions. Meetings should be like salt &ndash; sprinkled carefully to enhance a dish, not poured recklessly over every forkful. Too much salt destroys a dish. <strong>Too many meetings can destroy morale and motivation</strong>. Also, a 1 hour meeting with 5 people is actually a 5 hour meeting. A 1 hour meeting with 5 people means less 5 hours of productivity, not less 1 hour.</p>

<p>Let&rsquo;s sum it up:</p>

<ul>
<li>Work outside the office</li>
<li>Focus on the work, not the clock</li>
<li>Beware of the M&amp;M&rsquo;s</li>
</ul>


<blockquote><p><strong>&ldquo;The big transition with distributed workforce is going from synchronous to asynchronous collaboration. Not only do we not have to be in the same spot to work together, we also don’t have to work at the same time to work together.&rdquo; &ndash; Jason Fried &amp; David Heinemeier Hansson</strong></p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Pure functions]]></title>
    <link href="http://www.riot-control.net/2014/04/10/pure-functions/"/>
    <updated>2014-04-10T00:00:00+01:00</updated>
    <id>http://www.riot-control.net/2014/04/10/pure-functions</id>
    <content type="html"><![CDATA[<p>While learning scala/clojure and functional programming I have come across a
very familiar concept: <a href="http://en.wikipedia.org/wiki/Pure_function">pure functions</a>.
It reminds me of an <a href="http://www.riot-control.net/2013/12/03/the-almighty-interactor/">interactor</a>, but I
feel that is much more valuable as a concept. The <em>wikipedia</em> says that a function may
be considered pure if:</p>

<!-- more -->


<blockquote><ol>
<li>The function always evaluates the same result value given the same argument value(s). The function result value cannot depend on any hidden information or state that may change as program execution proceeds or between different executions of the program, nor can it depend on any external input from I/O devices.</li>
<li>Evaluation of the result does not cause any semantically observable side effect or output, such as mutation of mutable objects or output to I/O devices.</li>
</ol>
</blockquote>

<p>It may be difficult to build these kind of functions, it forces us to think
differently. Having a pure function doing our logic means that we are forced
to abstract from gateways, storages, and all kind of foreign dependencies.</p>

<p>However, building these pure functions yields several advantages:</p>

<ul>
<li>The function code is cleaner and easier to understand</li>
<li>It&rsquo;s easier to test; no dependecies, just focus on the logic</li>
<li>Because we don&rsquo;t have dependencies, we don&rsquo;t need mocks while testing</li>
<li>Pure functions can be easilly run on other threads, without worrying about
sync mechanisms</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Spotify culture]]></title>
    <link href="http://www.riot-control.net/2014/04/09/spotify-culture/"/>
    <updated>2014-04-09T00:00:00+01:00</updated>
    <id>http://www.riot-control.net/2014/04/09/spotify-culture</id>
    <content type="html"><![CDATA[Culture matters. We try hard to have a good culture on our team, a culture
of quality, helping each other, learning and having fun. This video from
Spotify is a great showcase of a good culture. But the most important thing isn&#8217;t
their culture, it&#8217;s the continuous effort to improve it.

<iframe src="http://player.vimeo.com/video/85490944?byline=0" width="500" height="313" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe> <p><a href="http://vimeo.com/85490944">Spotify Engineering Culture - part 1</a> from <a href="http://vimeo.com/user14023874">Spotify Training &amp; Development</a> on <a href="https://vimeo.com">Vimeo</a>.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Practical Object-Oriented Design in Ruby]]></title>
    <link href="http://www.riot-control.net/2014/04/03/practical-object-oriented-design-in-ruby/"/>
    <updated>2014-04-03T13:25:00+01:00</updated>
    <id>http://www.riot-control.net/2014/04/03/practical-object-oriented-design-in-ruby</id>
    <content type="html"><![CDATA[<p>Pratical Object-Oriented Design in Ruby by Sandi Metz</p>

<p><img src="http://www.riot-control.net/images/poodr.jpeg" height="300px" width="200px"/></p>

<p>This is one of my favorite Ruby books ever. It is very well written and a joy to read. I highly recommend this book.</p>

<p>So, why is software design so important?</p>

<p>When starting a new software application you have certain requirements. You analise these requirements, build your software and it works. As time goes by, those requirements will change and you will need to refactor your code. If you have a good design architecture, with loosely coupled classes, refactoring your code to meet the new requirements is easy. Otherwise, it will be very painful to make changes.</p>

<!-- more -->


<p>Software applications that are easy to change have these qualities:</p>

<ul>
<li><p><strong>Transparent</strong> &ndash; The consequences of change should be obvious in the code that is changing and in distant code that relies upon it.</p></li>
<li><p><strong>Reasonable</strong> &ndash; The cost of any change should be proportional to the benefits the change achieves.</p></li>
<li><p><strong>Usable</strong> &ndash; Existing code should be usable in new and unexpected contexts.</p></li>
<li><p><strong>Exemplary</strong> &ndash; The code itself should encourage those who change it to perpetuate
these qualities.</p></li>
</ul>


<p>Tests are another important aspect of well designed software. You can only refactor your code with confidence if you have tests. They also reduce the cost of maintaining your application and they supply valuable documentation.</p>

<p>&ldquo;An understanding of object-oriented design, good refactoring skills, and the ability to write efficient tests form a three-legged stool upon which changeable code rests. Well-designed code is easy to change, refactoring is how you change from one design to the next, and tests free you to refactor with impunity.&rdquo; &ndash; Sandi Metz</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Objects on Rails Book]]></title>
    <link href="http://www.riot-control.net/2014/02/14/objects-on-rails/"/>
    <updated>2014-02-14T13:47:00+00:00</updated>
    <id>http://www.riot-control.net/2014/02/14/objects-on-rails</id>
    <content type="html"><![CDATA[<p>Some time ago our team started to write code differently. Inspired by <a href="http://www.riot-control.net/2013/10/11/architecture-the-lost-years/">Architecture: The Lost Years</a>,
we started using <a href="http://www.riot-control.net/2013/12/03/the-almighty-interactor/">interactors</a> and <a href="http://www.riot-control.net/2013/11/27/refactoring-views-with-presenters-ruby-on-rails/">presenters</a>, greatly improving our code base.
We also started writting <em>rails-free</em> unit tests. It&rsquo;s good to know that <a href="http://devblog.reverb.com/post/70344683203/5-architecture-anti-patterns-and-solutions-for-large">we are not alone on this process</a>.
The <a href="http://objectsonrails.com/">Objects on Rails book</a> shows a step by step process to build this kind of code.</p>

<!-- more -->


<p>I really loved this book. It&rsquo;s more on the rails side than I would like, but it
still provided an enourmous amount of insights on application development. It&rsquo;s
also very <em>ruby intensive</em>, and I confess that I prefer code without deep ruby tricks.</p>

<p>I&rsquo;m awalys saying that I don&rsquo;t like to use constants in code. I always like an
abstraction on top of constants. Imagine that you have:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">PER_PAGE</span> <span class="o">=</span> <span class="mi">10</span>
</span></code></pre></td></tr></table></div></figure>


<p>And you use the <em>PER_PAGE</em> all over the place. Now if you need to have logic on
<em>per page</em>, for example, depending on the current user, you&rsquo;ll have to change it
all over the place. That&rsquo;s why I always do:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">per_page</span>
</span><span class='line'>  <span class="mi">10</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Objects on Rails made me think about this on a wider scope. This is a code smell:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">doc</span> <span class="o">=</span> <span class="no">Document</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>I we have this code all over the place, what happens if we need to inject some
logic on that find? An alternative:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">find_document</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">finder</span><span class="o">=</span><span class="no">Document</span><span class="p">)</span>
</span><span class='line'>  <span class="n">finder</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">doc</span> <span class="o">=</span> <span class="n">find_document</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This makes the code so much better for so many different reasons&hellip; The author
goes on step further and makes all ActiveRecord interface private on the models,
forcing you to write better code.</p>

<p>You can read the book online for free or spend 5$ and have it digital. It&rsquo;s a must
read!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Confident code]]></title>
    <link href="http://www.riot-control.net/2013/12/23/confident-code/"/>
    <updated>2013-12-23T13:47:00+00:00</updated>
    <id>http://www.riot-control.net/2013/12/23/confident-code</id>
    <content type="html"><![CDATA[<p>In Paulo&rsquo;s post about <a href="http://www.riot-control.net/2013/11/27/refactoring-views-with-presenters-ruby-on-rails/">presenters and views</a>,
he talked about how to make the view free of business logic. This is
<em>confident coding</em>. The following <em>talk</em> shows this in a wider perspective. Not
only for views/presenters, but for all code.</p>

<div class="ratio-4-3 embed-video-container" onclick="var myAnchor = document.getElementById('T8J0j2xJFgQ');var tmpDiv = document.createElement('div');tmpDiv.innerHTML = '&lt;iframe style=&quot;vertical-align:top;width:100%;height:100%;position:absolute;&quot; src=&quot;http://www.youtube.com/embed/T8J0j2xJFgQ?autoplay=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;';myAnchor.parentNode.replaceChild(tmpDiv.firstChild, myAnchor);return false;" title="click here to play">
<a class="youtube-lazy-link" style="width:100%;height:100%;background:#000 url(http://i2.ytimg.com/vi/T8J0j2xJFgQ/0.jpg) center center no-repeat;background-size:contain;position:absolute" href="http://www.youtube.com/watch?v=T8J0j2xJFgQ" id="T8J0j2xJFgQ" onclick="return false;">
<div class="youtube-lazy-link-div"></div>
<div class="youtube-lazy-link-info">Ruby Midwest 2011 Confident Code by Avdi Grimm</div>
</a>
<div class="video-info" >Are your methods timid? Do they constantly second-guess themselves, checking for nil values, errors, and unexpected input? Even the cleanest Ruby codebases can become littered over time with nil checks, error handling, and other interruptions which steal attention away from the essential purpose of the code. This talk will discuss strategies for writing your Ruby classes and methods in a confident, straightforward style; without sacrificing functionality or robustness. In the process, we&#8217;ll cover concepts and techniques points including: The narrative style of method construction The four parts of a method Three strategies for dealing with uncertain input Massaging input with coercion and the Decorator pattern Lightweight preconditions Exterminating nils from your code The chaining and iterative styles of method construction Eliminating conditionals with the Special Case and Null Object patterns Isolating errors with the Bouncer and Checked Method patterns</div>
</div>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Development by copy paste]]></title>
    <link href="http://www.riot-control.net/2013/12/18/development-by-copy-paste/"/>
    <updated>2013-12-18T13:21:00+00:00</updated>
    <id>http://www.riot-control.net/2013/12/18/development-by-copy-paste</id>
    <content type="html"><![CDATA[<p>I believe that <em>development by copy paste</em> is the worst work process that a programmer
may have. I&rsquo;m talking about having a piece of software working, and copying it
fully to another location on the same project, and performing some changes.</p>

<!-- more -->


<p> I may write some poor code if I&rsquo;m tired or in a rush. My compromise is that a
 piece of code may be poorly written, but there is only one point of access. It
 may be refactored later and unit tested later. And all the code that uses the bad one
 won&rsquo;t need to be changed (hopefully :).</p>

<p> When we copy paste large portions of code, we are creating a maintenance hell.
 No longer will we be able to change something in just one place. We&rsquo;ll have to find
 all related places to change that. And guess what? We will always miss the majority
 of them.</p>

<p>Some may argue that using this process is faster. I disagree. And I hope I&rsquo;ll never
have to support code from these guys.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Why Work Doesn't Happen at Work]]></title>
    <link href="http://www.riot-control.net/2013/12/09/why-work-doesnt-happen-at-work/"/>
    <updated>2013-12-09T12:11:00+00:00</updated>
    <id>http://www.riot-control.net/2013/12/09/why-work-doesnt-happen-at-work</id>
    <content type="html"><![CDATA[<p>Most people still think that the office is the best place to get work done. They think that a bunch of people need to be in the same room for great things to happen. Well, let me tell you that the office is full of distractions. In this short video, Jason Fried will tell you why work doesn’t happen at work. I guarantee you that these will be the best 15 minutes of your day. Enjoy!</p>

<div class="ratio-4-3 embed-video-container" onclick="var myAnchor = document.getElementById('5XD2kNopsUs');var tmpDiv = document.createElement('div');tmpDiv.innerHTML = '&lt;iframe style=&quot;vertical-align:top;width:100%;height:100%;position:absolute;&quot; src=&quot;http://www.youtube.com/embed/5XD2kNopsUs?autoplay=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;';myAnchor.parentNode.replaceChild(tmpDiv.firstChild, myAnchor);return false;" title="click here to play">
<a class="youtube-lazy-link" style="width:100%;height:100%;background:#000 url(http://i2.ytimg.com/vi/5XD2kNopsUs/0.jpg) center center no-repeat;background-size:contain;position:absolute" href="http://www.youtube.com/watch?v=5XD2kNopsUs" id="5XD2kNopsUs" onclick="return false;">
<div class="youtube-lazy-link-div"></div>
<div class="youtube-lazy-link-info">Jason Fried: Why work doesn&#8217;t happen at work</div>
</a>
<div class="video-info" >http://www.ted.com Jason Fried has a radical theory of working: that the office isn&#8217;t a good place to do it. At TEDxMidwest he lays out the main problems (call them the M&Ms) and offers three suggestions to make work work.

TEDTalks is a daily video podcast of the best talks and performances from the TED Conference, where the world&#8217;s leading thinkers and doers give the talk of their lives in 18 minutes. Featured speakers have included Al Gore on climate change, Philippe Starck on design, Jill Bolte Taylor on observing her own stroke, Nicholas Negroponte on One Laptop per Child, Jane Goodall on chimpanzees, Bill Gates on malaria and mosquitoes, Pattie Maes on the &#8220;Sixth Sense&#8221; wearable tech, and &#8220;Lost&#8221; producer JJ Abrams on the allure of mystery. TED stands for Technology, Entertainment, Design, and TEDTalks cover these topics as well as science, business, development and the arts. Closed captions and translated subtitles in a variety of languages are now available on TED.com, at http://www.ted.com/translate. Watch a highlight reel of the Top 10 TEDTalks at http://www.ted.com/index.php/talks/top10</div>
</div>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[The almighty interactor]]></title>
    <link href="http://www.riot-control.net/2013/12/03/the-almighty-interactor/"/>
    <updated>2013-12-03T13:21:00+00:00</updated>
    <id>http://www.riot-control.net/2013/12/03/the-almighty-interactor</id>
    <content type="html"><![CDATA[<p>The concept of the <em>interactor</em> is the biggest breakthrough that I have experienced in my
evolution as a programmer. It&rsquo;s simple, and it has always been right beside me. But
I have only acknowledged it when I saw <a href="http://www.riot-control.net/2013/10/11/architecture-the-lost-years/">Arquitecthure: the lost years</a>.</p>

<p>The concept is very simple. An interactor is:</p>

<!-- more -->


<ul>
<li>A class that handles business logic</li>
<li>It solves only one problem</li>
<li>It has a name in the form of an action: CreatePost, SendEmail, FinalizeDocument</li>
<li>It does not know anything about persistence (e.g. databases, ORM&rsquo;s)
and delivery mechanisms (e.g. Sinatra, Rails, CLI)</li>
<li>It maps directly to an use case, and only one use case</li>
</ul>


<p>An interactor like CreatePost needs to persist stuff. But it cannot know how.
To do so, it delegates the persistance to another class, a <em>gateway</em>. This gateway
may be an object that knows the persistence layer, or may be a dummy memory representation.</p>

<p>This separation makes sure that the interactor stays focused on it&rsquo;s task. And remains
very light. By being a plain ruby object, the interactor doesn&rsquo;t have dependecies
that will slow it down when running/booting tests.</p>

<p>Here&rsquo;s a small example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">AddNumbers</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="o">*</span><span class="n">numbers</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@numbers</span> <span class="o">=</span> <span class="n">numbers</span> <span class="o">||</span> <span class="o">[]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">may_run?</span>
</span><span class='line'>    <span class="kp">true</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">run</span>
</span><span class='line'>    <span class="vi">@numbers</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:+</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now the application knows how to add numbers via the <em>AddNumbers</em> class. We can create some
fast, database and framework independent unit tests. We can run it on <em>irb</em>, on a rake task
or on an async worker.</p>

<p>We build our application on top of interactors. And so should you.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Refactoring Views with Presenters (Ruby on Rails)]]></title>
    <link href="http://www.riot-control.net/2013/11/27/refactoring-views-with-presenters-ruby-on-rails/"/>
    <updated>2013-11-27T00:00:00+00:00</updated>
    <id>http://www.riot-control.net/2013/11/27/refactoring-views-with-presenters-ruby-on-rails</id>
    <content type="html"><![CDATA[<p>In a <strong>Ruby on Rails</strong> application, views can get really messy over time. They tend to grow into large files with <strong>if else blocks</strong> scattered all over the place.</p>

<p>Lately I&rsquo;ve been working on an existing application with views like these. My goal was to remove all the logic from the views into <strong>presenters</strong>, making the views smaller, more readable and easier to maintain.</p>

<!-- more -->


<p><strong>Let&rsquo;s look at an example:</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='erb'><span class='line'><span class="cp">&lt;%#</span><span class="c"> api.html.erb (before refactoring) </span><span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'>
</span><span class='line'><span class="x">&lt;div class=&quot;span9 no-margin&quot;&gt;</span>
</span><span class='line'><span class="x">  </span><span class="cp">&lt;%</span> <span class="k">if</span> <span class="vi">@user</span><span class="o">.</span><span class="n">current_membership</span><span class="o">.</span><span class="n">api_is_enabled?</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">    &lt;p&gt;</span>
</span><span class='line'><span class="x">      &lt;span class=&quot;api_key&quot;&gt;</span>
</span><span class='line'><span class="x">        </span><span class="cp">&lt;%=</span> <span class="vi">@user</span><span class="o">.</span><span class="n">current_membership</span><span class="o">.</span><span class="n">api_key</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">      &lt;/span&gt;</span>
</span><span class='line'><span class="x">    &lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="x">    &lt;div class=&quot;mButton float_right&quot;&gt;</span>
</span><span class='line'><span class="x">      </span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="n">t</span><span class="p">(</span><span class="s1">&#39;settings.api_regenerate&#39;</span><span class="p">),</span> <span class="n">api_key_path</span><span class="p">,</span> <span class="ss">:method</span> <span class="o">=&gt;</span> <span class="ss">:post</span><span class="p">,</span> <span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s1">&#39;aButton&#39;</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">    &lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="x">    &lt;div class=&quot;mButton float_right&quot;&gt;</span>
</span><span class='line'><span class="x">      </span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="n">t</span><span class="p">(</span><span class="s1">&#39;settings.api_disable&#39;</span><span class="p">),</span> <span class="n">api_key_path</span><span class="p">,</span> <span class="ss">:method</span> <span class="o">=&gt;</span> <span class="ss">:delete</span><span class="p">,</span> <span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s1">&#39;aButton&#39;</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">    &lt;/div&gt;</span>
</span><span class='line'><span class="x">    </span>
</span><span class='line'><span class="x">  </span><span class="cp">&lt;%</span> <span class="k">else</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">      &lt;div class=&quot;mButton float_right&quot;&gt;</span>
</span><span class='line'><span class="x">        </span><span class="cp">&lt;%=</span> <span class="n">link_to</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;settings.api_generate&#39;</span><span class="p">),</span> <span class="n">api_key_path</span><span class="p">,</span> <span class="ss">:method</span> <span class="o">=&gt;</span> <span class="ss">:post</span><span class="p">,</span> <span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s1">&#39;aButton&#39;</span><span class="p">)</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">      &lt;/div&gt;</span>
</span><span class='line'><span class="x">  </span><span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This view renders different html depending on the condition <strong>@user.current_membership.api_is_enabled?</strong>. What if in a near future another condition is needed? Probably an <strong>elsif</strong> would be added here and the view would grow even more. At some point it gets hard to understand the structure of the html. And when you know it, there&rsquo;s already repeated code in the view. Yes, you can always put that code in a helper. But I&rsquo;m not a fan of that approach either. Why? Because when calling helper methods in the view, it&rsquo;s not obvious where they come from. It feels like you&rsquo;re calling a function, not a method. Also, if multiple helpers are included in the view and there are methods with the same name, you&rsquo;ll get unexpected behavior.</p>

<p>Now, by placing the logic in a presenter you gain two things. First, the view contains only the html structure of the page. There is no decision making. The view acts simply as a template that shows data. Second, the code is placed in methods of the presenter. And by giving meaningful names, it becomes clear what the code does.</p>

<p><strong>Here&rsquo;s how the presenter looks like:</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># api_key_presenter.rb</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">ApiKeyPresenter</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@controller</span> <span class="o">=</span> <span class="n">controller</span>
</span><span class='line'>    <span class="vi">@view</span> <span class="o">=</span> <span class="n">view</span>
</span><span class='line'>    <span class="vi">@user</span> <span class="o">=</span> <span class="n">user</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">api_key</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">api_key_enabled?</span>
</span><span class='line'>      <span class="s2">&quot;</span><span class="si">#{</span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;settings.api_description&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&lt;span class=&#39;apiKey&#39;&gt;</span><span class="si">#{</span><span class="n">current_api_key</span><span class="si">}</span><span class="s2">&lt;/span&gt;&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">generate_api_key_button</span>
</span><span class='line'>    <span class="vi">@view</span><span class="o">.</span><span class="n">link_to</span> <span class="n">t</span><span class="p">(</span><span class="s1">&#39;settings.api_regenerate&#39;</span><span class="p">),</span> <span class="n">path</span><span class="p">(</span><span class="ss">:api_key_path</span><span class="p">),</span> <span class="ss">:method</span> <span class="o">=&gt;</span> <span class="ss">:post</span><span class="p">,</span> <span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s1">&#39;smallPrimaryButton rightButton&#39;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">disable_api_key_button</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">api_key_enabled?</span>
</span><span class='line'>      <span class="vi">@view</span><span class="o">.</span><span class="n">link_to</span> <span class="n">t</span><span class="p">(</span><span class="s1">&#39;settings.api_disable&#39;</span><span class="p">),</span> <span class="n">path</span><span class="p">(</span><span class="ss">:api_key_path</span><span class="p">),</span> <span class="ss">:method</span> <span class="o">=&gt;</span> <span class="ss">:delete</span><span class="p">,</span> <span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s1">&#39;smallDeleteButton&#39;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">api_key_enabled?</span>
</span><span class='line'>    <span class="vi">@user</span><span class="o">.</span><span class="n">current_membership</span><span class="o">.</span><span class="n">api_is_enabled?</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">current_api_key</span>
</span><span class='line'>    <span class="vi">@user</span><span class="o">.</span><span class="n">current_membership</span><span class="o">.</span><span class="n">api_key</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">path</span><span class="p">(</span><span class="n">sym</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kp">nil</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@controller</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">sym</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <strong>presenter</strong> has three public methods that can be used in the view: <strong>api_key</strong>, <strong>generate_api_key_button</strong> and <strong>disable_api_key_button</strong>. These method&rsquo;s names are clear and it&rsquo;s easy to understand what they do. The logic is in the presenter and the code is reusable and more maintainable.</p>

<p><strong>Here&rsquo;s how you can create the presenter in the controller:</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># users_controller.rb</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">api</span>
</span><span class='line'>    <span class="n">user</span> <span class="o">=</span> <span class="n">current_account</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@presenter</span> <span class="o">=</span> <span class="no">ApiKeyPresenter</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">self</span><span class="p">,</span> <span class="vi">@template</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>As you can see, three arguments are passed to the presenter: <strong>self</strong> (the controller), <strong>@template</strong> (the view) and the <strong>user</strong>.</p>

<p>(Note: In Rails 2 you can use <strong>@template</strong> to access the view. In Rails 3, <strong>@template</strong> would be replaced by <strong>view_context</strong>.)</p>

<p><strong>Let&rsquo;s see what the view looks like when using the presenter:</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='erb'><span class='line'><span class="cp">&lt;%#</span><span class="c"> api.html.erb (after refactoring) </span><span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'>
</span><span class='line'><span class="x">&lt;div class=&quot;span9 no-margin&quot;&gt;</span>
</span><span class='line'><span class="x">  &lt;p class=&quot;description&quot;&gt;</span>
</span><span class='line'><span class="x">    </span><span class="cp">&lt;%=</span> <span class="vi">@presenter</span><span class="o">.</span><span class="n">api_key</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">  &lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="x">  &lt;div id=&quot;containerBodyActions&quot;&gt;</span>
</span><span class='line'><span class="x">    </span><span class="cp">&lt;%=</span> <span class="vi">@presenter</span><span class="o">.</span><span class="n">generate_api_key_button</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">    </span><span class="cp">&lt;%=</span> <span class="vi">@presenter</span><span class="o">.</span><span class="n">disable_api_key_button</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">  &lt;/div&gt;</span>
</span><span class='line'><span class="x">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The view looks a lot nicer now. The html structure is clear, there&rsquo;s no logic in the view and there&rsquo;s no repeated code.</p>

<h1>Conclusion</h1>


<p>This example illustrates one of the many views I refactored. Not all of them were this simple but I think it&rsquo;s easier to show my point of view with a simple case.</p>

<p>These are the three major benefits I think this approach offers:</p>

<ul>
<li>Cleaner view</li>
<li>DRY code (presenter methods)</li>
<li>Separation of concerns</li>
</ul>


<p>Next time I start a new Ruby on Rails app, I will definitely use <strong>presenters</strong>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Architecture: The Lost Years]]></title>
    <link href="http://www.riot-control.net/2013/10/11/architecture-the-lost-years/"/>
    <updated>2013-10-11T13:47:00+01:00</updated>
    <id>http://www.riot-control.net/2013/10/11/architecture-the-lost-years</id>
    <content type="html"><![CDATA[

<div class="ratio-4-3 embed-video-container" onclick="var myAnchor = document.getElementById('WpkDN78P884');var tmpDiv = document.createElement('div');tmpDiv.innerHTML = '&lt;iframe style=&quot;vertical-align:top;width:100%;height:100%;position:absolute;&quot; src=&quot;http://www.youtube.com/embed/WpkDN78P884?autoplay=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;';myAnchor.parentNode.replaceChild(tmpDiv.firstChild, myAnchor);return false;" title="click here to play">
<a class="youtube-lazy-link" style="width:100%;height:100%;background:#000 url(http://i2.ytimg.com/vi/WpkDN78P884/0.jpg) center center no-repeat;background-size:contain;position:absolute" href="http://www.youtube.com/watch?v=WpkDN78P884" id="WpkDN78P884" onclick="return false;">
<div class="youtube-lazy-link-div"></div>
<div class="youtube-lazy-link-info">Ruby Midwest 2011 - Keynote: Architecture the Lost Years by Robert Martin</div>
</a>
<div class="video-info" >Robert C. Martin (Uncle Bob) has been a software professional since 1970. In the last 40 years, he has worked in various capacities on literally hundreds of software projects. He has authored &#8220;landmark&#8221; books on Agile Programming, Extreme Programming, UML, Object-Oriented Programming, C++ Programming and Clean Code. He has published dozens of articles in various trade journals. Today, he is one of the software industry&#8217;s leading authorities on Agile software development and is a regular speaker at international conferences and trade shows. He is a former editor of the C++ Report and writes regular blogs at http://cleancoder.posterous.com/.</div>
</div>



]]></content>
  </entry>
  
</feed>
